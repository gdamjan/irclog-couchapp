<!DOCTYPE html>
<html data-ng-app="ircLog">
<head>
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, target-densityDpi=medium-dpi">
   <meta content='True' name='HandheldFriendly'>

   <title>IRClogger 2.0</title>

   <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.1.5/angular.min.js"></script>
   <script src="script/angular-cornercouch.js"></script>
   <script src="script/angular-colorizer.js"></script>
   <script src="script/irclog-app.js"></script>
   <link type="text/css" rel="stylesheet" href="style/style.css" />
   <link rel="apple-touch-icon" href="images/favicon.png" />
   <link rel="shortcut icon" type="image/png" href="images/favicon.png" />
</head>
<body>
<header>
   <h1 ng-bind=title>IRC logs with realtime updates</h1>
</header>

<!-- placeholder for partial views -->
<div data-ng-view=""></div>

<footer>
  <div>
    <a href="https://irc.softver.org.mk/">irclog home page</a>
  </div>
</footer>

<a href="https://github.com/gdamjan/irclog-couchapp"><img
    style="position: absolute; top: 0; right: 20px; border: 0;"
    src="images/green-black.png"
    alt="Fork me on GitHub"></a>


<script type="text/ng-template" id="channel-logs.html">
<div>
  <div class="pagination" ng-click="prevClick()" ng-show="db.nextRow">&#8593;previous history&#8593;</div>
  <table id="irclog">
     <tbody id="2013-07-08"> <!-- FIXME THIS -->
     <tr class="date">
        <th colspan="2"><span><a href="#/lugola/2013-07-08">2013-07-08</a></span></th>
     </tr>
     <tr data-ng-repeat="row in db.rows | orderBy:'doc.timestamp'">
        <td class="message">
           <span class="nickname" style="background-color:{{row.doc.sender | colorize}}">{{row.doc.sender}}</span>
           <span>{{row.doc.message}}</span>
        </td>
        <td class="timestamp" valign="top" width="1%">
           <a id="{{row.id}}" href="#/{{channel}}/{{row.id}}">{{1000* row.doc.timestamp | date:'HH:mm:ss'}}</a>
        </td>
     </tr>
  </table>
  <div class="pagination" ng-click="nextClick()" ng-show="db.prevRows.length">&#8595;more history&#8595;</div>
</div>
</script>

<script type="text/ng-template" id="start.html">
<div id="infobox">
   <p>
   This web page is a viewer of irclogs collected by my
   <a href="https://github.com/gdamjan/erlang-irc-bot">erlang irc bot</a>.
   The bot stores the logs in a CouchDB where this web-app (or couchapp)
   is also stored. You can also <a href="http://wiki.apache.org/couchdb/Replication">replicate</a>
   the database at https://irc.softver.org.mk/api freely.
   </p>
   <p>
   The following channels are currently logged:
   </p>
   <ul>
      <li data-ng-repeat="channel in channels">
      <a href="#/{{channel}}">{{ channel }}</a>
      </li>
   </ul>
   <p>If you want your irc channel on freenode logged, contact 'damjan' on #lugola.</p>
</div>
</script>

</body>
</html>
